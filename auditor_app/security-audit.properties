# =============================================================================
# security-audit.properties – FIPS Audit Mode provider configuration
#
# Load with:  -Djava.security.properties==security-audit.properties
#             (double == replaces the entire JDK default provider list)
#
# Provider chain:
#   1. FipsAuditProvider  – intercepts every JCA call, delegates to a
#                           directly-held BouncyCastleFipsProvider instance.
#                           On FipsUnapprovedOperationError it logs the caller
#                           stack to fips-audit.log, then delegates to the
#                           next capable native provider below.
#   2-10. Standard JDK   – native providers for SecureRandom and for
#                           non-FIPS fallback delegation.
#
# IMPORTANT: BCFIPS is intentionally NOT registered in this provider chain.
# FipsAuditProvider holds a direct reference to a BouncyCastleFipsProvider
# instance that is auto-initialised from the classpath. This avoids the
# StackOverflowError caused by BCFIPS's internal circular SecureRandom
# bootstrap when BCFIPS is not the first provider.
# =============================================================================

# ---- 1. FIPS Audit Bridge (intercepts and logs non-FIPS delegations) -------
security.provider.1=com.demo.fips.audit.FipsAuditProvider

# ---- 2-10. Standard JDK providers -----------------------------------------
security.provider.2=SUN
security.provider.3=SunRsaSign
security.provider.4=SunEC
security.provider.5=SunJSSE
security.provider.6=SunJCE
security.provider.7=SunJGSS
security.provider.8=SunSASL
security.provider.9=XMLDSig
security.provider.10=SunPCSC
