# =============================================================================
# fips-policy.properties — FIPS Audit Policy Configuration
#
# Defines which JCA algorithm/mode/padding combinations are considered
# WEAK or DISALLOWED beyond what BCFIPS itself enforces.
#
# BCFIPS in approved-only mode already rejects truly non-FIPS algorithms
# (MD5, DES, RC4, etc.).  This file adds a policy layer for configurations
# that are technically FIPS-compliant but operationally weak or deprecated.
#
# Format:
#   <type>.<algorithm>[.<mode>][.<padding>] = APPROVED | WEAK | DISALLOWED
#
# Lookup order (most specific wins):
#   1. Cipher.AES.ECB.NoPadding          (full match)
#   2. Cipher.AES.ECB                    (mode match)
#   3. Cipher.AES                        (algorithm match)
#   4. (not found) → defer to BCFIPS probe result
#
# Values:
#   APPROVED    — no audit log entry (silent pass-through)
#   WEAK        — audit log entry with reason, then delegate to native
#   DISALLOWED  — audit log entry with reason, then delegate to native
#                 (same behaviour as WEAK, different severity label)
#
# Reason text after the | pipe is included in the audit log entry.
# If omitted, a default reason is used.
#
# Reference: NIST SP 800-131A Rev 2, SP 800-38A, FIPS 140-3
# =============================================================================

# ─── Cipher modes ───────────────────────────────────────────────────────────

# ECB leaks block-level patterns; not recommended for multi-block data
Cipher.AES.ECB          = WEAK | ECB mode leaks block-level patterns (NIST SP 800-38A)
Cipher.DESede.ECB       = WEAK | ECB mode leaks block-level patterns

# CBC without authentication is vulnerable to padding oracle attacks
# Uncomment if your policy requires authenticated encryption:
# Cipher.AES.CBC        = WEAK | CBC without authentication (consider GCM/CCM)

# Approved strong modes (explicit — optional, these are the default)
Cipher.AES.GCM          = APPROVED
Cipher.AES.CCM          = APPROVED
Cipher.AES.CTR          = APPROVED
Cipher.AES.CBC          = APPROVED

# ─── Deprecated algorithms (FIPS-valid but end-of-life) ─────────────────────

# 3DES / DESede — deprecated by NIST after 2023 (SP 800-131A Rev 2)
Cipher.DESede            = WEAK | 3DES deprecated by NIST after 2023 (SP 800-131A Rev 2)
KeyGenerator.DESede      = WEAK | 3DES deprecated by NIST after 2023

# ─── Hash algorithms ────────────────────────────────────────────────────────

# SHA-1 is FIPS-approved for hashing but deprecated for digital signatures
MessageDigest.SHA-1      = WEAK | SHA-1 deprecated for signatures (NIST SP 800-131A Rev 2)

# Approved hash algorithms (explicit)
MessageDigest.SHA-256    = APPROVED
MessageDigest.SHA-384    = APPROVED
MessageDigest.SHA-512    = APPROVED
MessageDigest.SHA3-256   = APPROVED
MessageDigest.SHA3-512   = APPROVED

# ─── Signatures ─────────────────────────────────────────────────────────────

Signature.SHA1withRSA         = WEAK | SHA-1 deprecated for signatures
Signature.SHA1withECDSA       = WEAK | SHA-1 deprecated for signatures
Signature.SHA1withDSA         = WEAK | SHA-1 deprecated for signatures

# ─── MAC ────────────────────────────────────────────────────────────────────

Mac.HmacSHA1             = WEAK | HMAC-SHA1 acceptable but SHA-256+ preferred

# ─── Key sizes (informational — cannot be enforced at getInstance time) ─────
# Key size checks require runtime inspection after key generation.
# These entries serve as documentation only:
# KeyPairGenerator.RSA.keysize<2048 = DISALLOWED | RSA key < 2048 bits
# KeyPairGenerator.EC.keysize<224   = DISALLOWED | EC key < 224 bits
